<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" href="/favicon.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ponte Finance - Property Investment Marketplace">
    <title>Ponte Finance - Property Investment Marketplace</title>
    <!-- Open Graph meta tags placeholder - will be updated dynamically -->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Ponte Finance">
    <script type="text/javascript">(function(w,s){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="https://cdn.pagesense.io/js/pontefinances/f3ff71b494b344b38d575dde58d71971.js";var x=document.getElementsByTagName("script")[0];x.parentNode.insertBefore(e,x);})(window,"script");</script>
    <script>
      // Script to fetch and inject meta tags for WhatsApp scraping
      (function() {
        // Check if this is a property page
        var path = window.location.pathname;
        var propertyMatch = path.match(/\/investor\/property\/(\d+)/);
        
        if (propertyMatch) {
          var propertyId = propertyMatch[1];
          var baseUrl = window.location.origin;
          
          // Fetch property data synchronously for WhatsApp scraping
          var xhr = new XMLHttpRequest();
          xhr.open('GET', 'https://ponte.finance/wp-json/ponte/v1/properties/' + propertyId, false);
          xhr.send();
          
          if (xhr.status === 200) {
            try {
              var response = JSON.parse(xhr.responseText);
              var property = response.data || response;
              
              if (property) {
                var title = property.title || 'Property Investment Opportunity';
                var description = (property.description || property.full_description || 'Check out this property investment opportunity on Ponte Finance').substring(0, 200);
                var image = '';
                
                // Get image URL
                if (property.images && property.images.length > 0) {
                  image = property.images[0].url || property.images[0];
                } else if (property.primary_image) {
                  image = typeof property.primary_image === 'string' ? property.primary_image : property.primary_image.url;
                } else {
                  // Fallback to mock images
                  var mockImages = {
                    '1': 'https://ponte.finance/wp-content/uploads/marketplace/exemplos/imovel01.jpg',
                    '2': 'https://ponte.finance/wp-content/uploads/marketplace/exemplos/imovel02.jpg',
                    '3': 'https://ponte.finance/wp-content/uploads/marketplace/exemplos/imovel03.jpg',
                    '4': 'https://ponte.finance/wp-content/uploads/marketplace/exemplos/imovel04.jpg'
                  };
                  image = mockImages[property.id] || 'https://ponte.finance/wp-content/uploads/marketplace/exemplos/imovel01.jpg';
                }
                
                // Ensure image URL is absolute
                if (image && !image.startsWith('http')) {
                  if (image.startsWith('/')) {
                    image = baseUrl + image;
                  } else {
                    image = baseUrl + '/' + image;
                  }
                }
                
                var propertyUrl = baseUrl + '/investor/property/' + propertyId;
                
                // Update or create meta tags
                function setMetaTag(property, content) {
                  var element = document.querySelector('meta[property="' + property + '"]');
                  if (!element) {
                    element = document.createElement('meta');
                    element.setAttribute('property', property);
                    document.head.appendChild(element);
                  }
                  element.setAttribute('content', content);
                }
                
                function setTwitterMetaTag(name, content) {
                  var element = document.querySelector('meta[name="' + name + '"]');
                  if (!element) {
                    element = document.createElement('meta');
                    element.setAttribute('name', name);
                    document.head.appendChild(element);
                  }
                  element.setAttribute('content', content);
                }
                
                // Set Open Graph tags
                setMetaTag('og:title', title);
                setMetaTag('og:description', description);
                setMetaTag('og:image', image);
                setMetaTag('og:image:url', image);
                setMetaTag('og:image:secure_url', image);
                setMetaTag('og:url', propertyUrl);
                setMetaTag('og:type', 'website');
                
                // Set Twitter Card tags
                setTwitterMetaTag('twitter:card', 'summary_large_image');
                setTwitterMetaTag('twitter:title', title);
                setTwitterMetaTag('twitter:description', description);
                setTwitterMetaTag('twitter:image', image);
                
                // Update title
                document.title = title + ' - Ponte Finance';
                
                // Update description
                var descMeta = document.querySelector('meta[name="description"]');
                if (descMeta) {
                  descMeta.setAttribute('content', description);
                }
              }
            } catch (e) {
              console.error('Error parsing property data:', e);
            }
          }
        }
      })();
    </script>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.js"></script>
  </body>
</html>
